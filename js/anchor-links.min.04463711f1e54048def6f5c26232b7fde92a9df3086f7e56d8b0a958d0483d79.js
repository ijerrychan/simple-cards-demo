document.addEventListener("DOMContentLoaded",function(){"use strict";const u=document.querySelectorAll("article h1, article h2, article h3, article h4, article h5, article h6");if(window.location.hash){const e=document.querySelector(window.location.hash);e&&setTimeout(()=>{location.hash=window.location.hash},100)}const e=[],h=new Map;u.forEach(t=>{if(t.id){const n=document.querySelector(`.article-toc a[href="#${t.id}"]`);if(n){const s={heading:t,link:n,id:t.id,top:0};e.push(s),h.set(t,n)}}});let o=0,i=null,d=window.innerHeight,t=!1,s=null;function n(){if(window.innerWidth<=768)return;const n=window.pageYOffset||document.documentElement.scrollTop;if(Math.abs(n-o)<10)return;o=n;const a=n-50;let t=null,s=-1;if(e.forEach((i,r)=>{if(i.top===0||Math.abs(n-o)>100){const e=i.heading.getBoundingClientRect();i.top=e.top+n}i.top>a&&(s===-1||i.top<e[s].top)&&(t=i.heading,s=r)}),t===null&&e.length>0&&(t=e[0].heading,s=0),t===i)return;if(i=t,e.forEach(e=>{e.link.classList.remove("active","read")}),t){const n=e.find(e=>e.heading===t);if(n){n.link.classList.add("active");for(let t=0;t<s;t++)e[t].link.classList.add("read");setTimeout(()=>{const e=n.link.closest("nav");if(e){const t=n.link.getBoundingClientRect(),s=e.getBoundingClientRect();(t.top<s.top+50||t.bottom>s.bottom-50)&&n.link.scrollIntoView({block:"center"})}},50)}}}let a=null,r=0;function m(){const e=performance.now();if(e-r<16){a||(a=requestAnimationFrame(()=>{n(),a=null,r=performance.now()}));return}n(),r=e}window.addEventListener("scroll",m,{passive:!0});let l;window.addEventListener("resize",()=>{clearTimeout(l),l=setTimeout(()=>{d=window.innerHeight,e.forEach(e=>{e.top=0}),i=null,n()},150)});const c=document.querySelector(".article-toc nav");c&&(c.addEventListener("scroll",()=>{t=!0,clearTimeout(s),s=setTimeout(()=>{t=!1},2e3)}),c.addEventListener("click",()=>{t=!0,clearTimeout(s),s=setTimeout(()=>{t=!1},2e3)})),setTimeout(n,50)})